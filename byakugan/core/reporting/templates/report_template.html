<!DOCTYPE html>
<html>
<head>
    <title>Byakugan Scan Report</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 2em;
        }
        .finding {
            border: 1px solid #ddd;
            margin: 1em 0;
            padding: 1em;
        }
        .evidence {
            background: #f5f5f5;
            padding: 1em;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .cvss {
            display: inline-block;
            padding: 0.2em 0.5em;
            color: white;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>Security Scan Report</h1>
    
    <section class="scan-info">
        <h2>Scan Information</h2>
        <table>
            <tr>
                <th>Target:</th>
                <td>{{ scan_info.target }}</td>
            </tr>
            <tr>
                <th>Start Time:</th>
                <td>{{ scan_info.start_time }}</td>
            </tr>
            <tr>
                <th>Duration:</th>
                <td>{{ scan_info.duration }} seconds</td>
            </tr>
        </table>
    </section>

    <section class="summary">
        <h2>Summary</h2>
        <table>
            <tr>
                <th>Total Findings:</th>
                <td>{{ summary.total_findings }}</td>
            </tr>
            {% for severity, count in summary.severity_counts.items() %}
            <tr>
                <th>{{ severity|title }}:</th>
                <td>{{ count }}</td>
            </tr>
            {% endfor %}
        </table>
    </section>

    <section class="findings">
        <h2>Findings</h2>
        {% for finding in findings %}
        <div class="finding">
            <h3>
                {{ finding.title }}
                <span class="cvss" style="background-color: {{ finding.cvss_color }}">
                    CVSS: {{ finding.cvss_score }}
                </span>
            </h3>
            <div class="description">
                {{ finding.description_html|safe }}
            </div>
            {% if finding.formatted_evidence %}
            <div class="evidence">
                <h4>Request:</h4>
                {{ finding.formatted_evidence.request }}
                
                <h4>Response:</h4>
                {{ finding.formatted_evidence.response }}
                
                {% if finding.formatted_evidence.proof %}
                <h4>Proof:</h4>
                {{ finding.formatted_evidence.proof }}
                {% endif %}
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </section>

    <footer>
        <p>Generated by Byakugan at {{ generated_at }}</p>
    </footer>
</body>
</html>